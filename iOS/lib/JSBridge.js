"use strict";!function(e,t){function n(){}function i(e,t){I[e]=t}function a(e){I[e]&&delete I[e]}function o(e,t,n){console.log("[send]eventName:"+e+", data: "+JSON.stringify(t));var i={};if(i[N]=m,e&&(i[S]=e),t&&(i[p]=t),n){var a="js_cb_"+C++ +"_"+(new Date).getTime();B[a]=n,i[O]=a}u(i)}function s(e,t,n){var i={};i[N]=b,i[J]=e,i[O]=t,n&&(i[p]=n),u(i)}function c(e){console.log("dispatchMessage: "+JSON.stringify(e)),setTimeout(function(){try{e.method==m?d(e):e.method==b&&r(e)}catch(e){s(404,{JBX_KEY_DESCRIPTION:"Not Found"})}})}function d(e){var t=e.callbackId;responseCallback=function(e){t&&s(200,t,e)};var n=I[e.eventName];n?n(e.data,responseCallback):s(404,{JBX_KEY_DESCRIPTION:"Not Found"})}function r(e){var t=e.callbackId;if(void 0!==t){var n=B[t];n&&n(e.code,e.data)}}function u(e){A.push(e),l()}function l(){if(T)v.src=h+"://"+_+E;else try{AndroidAPI.dispatchMessageQueueFromJS(g())}catch(e){console.log(e)}}function g(){try{var e=A;A=[];var t=JSON.stringify(e);return console.log("[fetchMessageQueue] messages: "+t),t}catch(e){console.log(e)}return[]}function f(e,t,n){o(METHOD_SEND,t,n)}if(!e.JSBridge){var v,h="torlaxbridge",_="__TORLAX_HOST__",E="/__TORLAX_EVENT__",m="SEND",b="CALLBACK",N="method",S="eventName",p="data",J="code",O="callbackId",y=navigator.userAgent,T=/i(Phone|Pod|Pad|OS)/g.test(y),A=(/Android/g.test(y),[]),I={},B={},C=1;e.JSBridge={init:n.bind(this),registerEvent:i.bind(this),unregisterEvent:a.bind(this),send:o.bind(this),dispatchMessageFromNative:c.bind(this),fetchMessageQueue:g.bind(this),ajax:f.bind(this)},v=t.createElement("iframe"),v.style.display="none",l(),t.documentElement.appendChild(v);var D=t.createEvent("Events");D.initEvent("JSBridgeReady"),D.bridge=JSBridge,t.dispatchEvent(D)}}(window,document);