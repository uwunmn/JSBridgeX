"use strict";!function(e,t){function n(e){h=e}function i(e,t){F[e]=t}function o(e){F[e]&&delete F[e]}function s(e,t,n){console.log("[send]eventName:"+e+", data: "+JSON.stringify(t));var i={};if(i[_]=N,e&&(i[J]=e),t&&(i[y]=t),n){var o="js_cb_"+C++ +"_"+(new Date).getTime();k[o]=n,i[A]=o}g(i)}function a(e,t,n){var i={};i[_]=S,i[p]=e,i[A]=t,n&&(i[y]=n),g(i)}function c(){s("listAllEvents",null,function(e,t){console.log("Events: "+JSON.stringify(t.Events))})}function d(e){console.log("dispatchMessageFromNative: "+JSON.stringify(e)),setTimeout(function(){try{e.method==N?r(e):e.method==S&&l(e)}catch(e){console.log(e)}})}function r(e){console.log("handleMessageSentFromNative");var t=e.callbackId,n=F[e.eventName];return n?void n(e.data,function(e,n){t&&a(e,t,n)}):void h(e)}function l(e){console.log("handleMessageCallbackFromNative");var t=e.callbackId;if(void 0!==t){var n=k[t];n&&n(e.data,e.code)}}function g(e){O.push(e),u()}function u(){if(M)f.src=m+"://"+E+b;else try{AndroidAPI.dispatchMessageQueueFromJS(v())}catch(e){console.log(e)}}function v(){try{var e=O;O=[];var t=JSON.stringify(e);return console.log("[fetchMessageQueue] messages: "+t),t}catch(e){console.log(e)}return[]}if(!e.JSBridge){var f,h,m="jsbridgex",E="__JBX_HOST__",b="/__JBX_EVENT__",N="SEND",S="CALLBACK",_="method",J="eventName",y="data",p="code",A="callbackId",B=navigator.userAgent,M=/i(Phone|Pod|Pad|OS)/g.test(B),O=(/Android/g.test(B),[]),F={},k={},C=1;e.JSBridge={init:n.bind(this),registerEvent:i.bind(this),unregisterEvent:o.bind(this),send:s.bind(this),dispatchMessageFromNative:d.bind(this),fetchMessageQueue:v.bind(this),listAllEvents:c.bind(this)},f=t.createElement("iframe"),f.style.display="none",u(),t.documentElement.appendChild(f);var I=t.createEvent("Events");I.initEvent("JSBridgeReady"),I.bridge=JSBridge,t.dispatchEvent(I)}}(window,document);