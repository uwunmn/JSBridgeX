"use strict";!function(e,t){function n(e){h=e}function i(e,t){k[e]=t}function o(e){k[e]&&delete k[e]}function s(e,t,n){console.log("[send]eventName:"+e+", data: "+JSON.stringify(t));var i={};if(i[S]=y,e&&(i[_]=e),t&&(i[p]=t),"function"==typeof n){var o="js_cb_"+I++ +"_"+(new Date).getTime();C[o]=n,i[A]=o}u(i)}function a(e,t,n){var i={};i[S]=N,i[J]=e,i[A]=t,n&&(i[p]=n),u(i)}function c(){s("listAllEvents",null,function(e,t){console.log("Events: "+JSON.stringify(t.Events))})}function d(e){console.log("dispatchMessageFromNative: "+JSON.stringify(e)),setTimeout(function(){try{e.method==y?r(e):e.method==N&&l(e)}catch(e){console.log(e)}})}function r(e){console.log("handleMessageSentFromNative");var t=e.callbackId,n=k[e.eventName];return"function"==typeof n?void n(e.data,function(e,n){t&&a(e,t,n)}):void("function"==typeof h&&h(e))}function l(e){console.log("handleMessageCallbackFromNative");var t=e.callbackId;if(!t){var n=C[t];"function"==typeof n&&n(e.data,e.code)}}function u(e){F.push(e),f()}function f(){if(M)v.src=m+"://"+E+b;else if(O)try{AndroidAPI.dispatchMessageQueueFromJS(g())}catch(e){console.log(e)}}function g(){try{var e=F;F=[];var t=JSON.stringify(e);return console.log("[fetchMessageQueue] messages: "+t),t}catch(e){console.log(e)}return[]}if(!e.JSBridge){var v,h,m="jsbridgex",E="__JBX_HOST__",b="/__JBX_EVENT__",y="SEND",N="CALLBACK",S="method",_="eventName",p="data",J="code",A="callbackId",B=navigator.userAgent,M=/i(Phone|Pod|Pad|OS)/g.test(B),O=/Android/g.test(B),F=[],k={},C={},I=1;e.JSBridge={init:n.bind(this),registerEvent:i.bind(this),unregisterEvent:o.bind(this),send:s.bind(this),dispatchMessageFromNative:d.bind(this),fetchMessageQueue:g.bind(this),listAllEvents:c.bind(this)},v=t.createElement("iframe"),v.style.display="none",f(),t.documentElement.appendChild(v);var P=t.createEvent("Events");P.initEvent("JSBridgeReady"),P.bridge=JSBridge,t.dispatchEvent(P)}}(window,document);