!function(e,t){function i(){var e=N;N=null;for(var t=0;t<e.length;t++)l(e[t])}function n(e,t){S[e]=t}function a(e){S[e]&&delete S[e]}function s(e,t,i){console.log("[send]eventName:"+e+"data: "+JSON.stringify(t));var n={};if(n.method=u,e&&(n.eventName=e),t&&(n.data={data:t}),i){var a="js_cb_"+J++ +"_"+(new Date).getTime();y[a]=i,n.callbackId=a}l(n)}function o(e,t,i){var n={};n.method=m,n.code=e,n.callbackId=t,i&&(n.data=i),l(n)}function c(e){console.log("_dispatchMessageFromNative:"+JSON.stringify(e)),N?(console.log("receivedMessages"),N.push(e)):d(e)}function d(e){console.log("dispatchMessage: "+JSON.stringify(e)),setTimeout(function(){try{var t=e.callbackId;if(e.method==u){console.log("dispatchMessage: "+u+"callbackId:"+t),responseCallback=function(e){t&&o(200,t,e)};var i=S[e.eventName];i?i(e.data,responseCallback):o(404)}else if(e.method==m){if(console.log("dispatchMessage: "+m+"callbackId:"+t+", code: "+e.code),void 0===t)return;var n=y[t];n&&n(e.code,e.data)}}catch(e){}})}function l(e){p.push(e),r()}function r(){console.log("[triggerNativeCall]"),setTimeout(function(){if(b)g.src=v+"://"+f+"/"+h;else try{var e=p;p=[],console.log("[triggerNativeCall] messages: "+JSON.stringify(e)),AndroidAPI.dispatchJSMessageQueue(JSON.stringify(e))}catch(e){console.log(e)}})}if(!e.JSBridge){var g,v="jsridgexscheme",f="__URL_HOST__",h="__URL_PATH__",u="SEND",m="CALLBACK",_=navigator.userAgent,b=/i(Phone|Pod|Pad|OS)/g.test(_),p=(/Android/g.test(_),[]),N=[],S={},y={},J=1;e.JSBridge={init:i.bind(this),send:s.bind(this),registerEvent:n.bind(this),deRegisterEvent:a.bind(this),_dispatchMessageFromNative:c.bind(this)},g=t.createElement("iframe"),g.style.display="none",r(),t.documentElement.appendChild(g);var E=t.createEvent("Events");E.initEvent("JSBridgeReady"),E.bridge=JSBridge,t.dispatchEvent(E)}}(window,document);