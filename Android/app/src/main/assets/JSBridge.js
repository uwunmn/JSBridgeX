"use strict";!function(e,t){function n(e){f=e}function i(e,t){T[e]=t}function a(e){T[e]&&delete T[e]}function o(e,t,n){console.log("[send]eventName:"+e+", data: "+JSON.stringify(t));var i={};if(i[S]=_,e&&(i[E]=e),t&&(i[y]=t),n){var a="js_cb_"+F++ +"_"+(new Date).getTime();B[a]=n,i[A]=a}l(i)}function s(e,t,n){var i={};i[S]=N,i[p]=e,i[A]=t,n&&(i[y]=n),l(i)}function c(e){console.log("dispatchMessageFromNative: "+JSON.stringify(e)),setTimeout(function(){try{e.method==_?d(e):e.method==N&&r(e)}catch(e){console.log(e)}})}function d(e){console.log("handleMessageSentFromNative");var t=e.callbackId,n=T[e.eventName];n?n(e.data,function(e,n){t&&s(e,t,n)}):f(e)}function r(e){console.log("handleMessageCallbackFromNative");var t=e.callbackId;if(void 0!==t){var n=B[t];n&&n(e.code,e.data)}}function l(e){O.push(e),g()}function g(){if(M)v.src=h+"://"+m+b;else try{AndroidAPI.dispatchMessageQueueFromJS(u())}catch(e){console.log(e)}}function u(){try{var e=O;O=[];var t=JSON.stringify(e);return console.log("[fetchMessageQueue] messages: "+t),t}catch(e){console.log(e)}return[]}if(!e.JSBridge){var v,f,h="torlaxbridge",m="__TORLAX_HOST__",b="/__TORLAX_EVENT__",_="SEND",N="CALLBACK",S="method",E="eventName",y="data",p="code",A="callbackId",J=navigator.userAgent,M=/i(Phone|Pod|Pad|OS)/g.test(J),O=(/Android/g.test(J),[]),T={},B={},F=1;e.JSBridge={init:n.bind(this),registerEvent:i.bind(this),unregisterEvent:a.bind(this),send:o.bind(this),dispatchMessageFromNative:c.bind(this),fetchMessageQueue:u.bind(this)},v=t.createElement("iframe"),v.style.display="none",g(),t.documentElement.appendChild(v);var k=t.createEvent("Events");k.initEvent("JSBridgeReady"),k.bridge=JSBridge,t.dispatchEvent(k)}}(window,document);